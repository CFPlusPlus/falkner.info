---
import BaseLayout from "../layouts/BaseLayout.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
import Divider from "../components/Divider.astro";
import Button from "../components/Button.astro";
import Chip from "../components/Chip.astro";
import Icon from "../components/Icon.astro";
import { site } from "../lib/site";

// Für eine 404-Seite sind klassische One-Pager-Ankerlinks praktisch,
// damit man sofort wieder „in die Seite rein“ findet.
const navLinks = [
  { label: "Startseite", href: "/" },
  { label: "Projekte", href: "/#projects" },
  { label: "Kontakt", href: "/#contact" },
];

const quickLinks = [
  { label: "Über mich", href: "/#about", icon: "user" },
  { label: "Projekte", href: "/#projects", icon: "folder" },
  { label: "Interessen", href: "/#stack", icon: "sparkles" },
  { label: "Bilder", href: "/#gallery", icon: "photo" },
  { label: "Kontakt", href: "/#contact", icon: "mail" },
  { label: "Datenschutz", href: "/datenschutz", icon: "lock" },
];
---

<BaseLayout
  title={`404 – ${site.domain}`}
  description="Diese Seite existiert (leider) nicht. Zurück zur Startseite oder direkt zu den wichtigsten Bereichen."
  canonicalPath="/404/"
>
  <Fragment slot="head">
    <!--
      404-Seiten sollten nicht indexiert werden.
      (Sitemap wird zusätzlich im astro.config gefiltert.)
    -->
    <meta name="robots" content="noindex, nofollow, noarchive" />
    <meta name="googlebot" content="noindex, nofollow, noarchive" />
  </Fragment>

  <Navbar brand={site.domain} links={navLinks} />

  <main class="py-16 sm:py-20">
    <div class="mx-auto max-w-6xl px-5">
      <div class="max-w-3xl reveal">
        <div class="flex flex-wrap items-center gap-2">
          <Chip tone="neutral">Fehler</Chip>
          <Chip>404</Chip>
        </div>

        <h1 class="mt-6 text-4xl sm:text-6xl font-[450] tracking-tight leading-[1.03]">
          Seite nicht gefunden
        </h1>
        <p class="mt-5 text-base sm:text-lg text-muted leading-relaxed">
          Der Link führt ins Leere. Vielleicht hat sich die URL geändert — oder es war ein Tippfehler.
        </p>

        <Divider class="mt-8" />
      </div>

      <div class="mt-10 grid gap-6 lg:grid-cols-[1.1fr_0.9fr] lg:items-start">
        <section class="reveal" style="--reveal-delay: 90ms">
          <div class="relative overflow-hidden rounded-lg border border-border/70 bg-surface/55 backdrop-blur-xl p-6 shadow-soft">
            <!-- Subtile „Artboard“-Highlights, passend zu deinem globalen Blob-Look -->
            <!--
              Wichtig: Diese Deko-Layer dürfen keine Klicks „abfangen“.
              Ohne pointer-events-none liegen absolute Elemente schnell über dem Inhalt.
            -->
            <div aria-hidden="true" class="absolute -top-20 -right-24 h-[340px] w-[340px] rounded-full bg-accent/12 blur-3xl pointer-events-none"></div>
            <div aria-hidden="true" class="absolute -bottom-24 -left-24 h-[360px] w-[360px] rounded-full bg-accent2/10 blur-3xl pointer-events-none"></div>
            <div aria-hidden="true" class="absolute inset-0 pointer-events-none [box-shadow:inset_0_0_60px_rgba(0,0,0,0.35)]"></div>

            <div class="flex items-start justify-between gap-6">
              <div>
                <div class="meta">Status</div>
                <div class="mt-2 text-6xl sm:text-7xl font-[450] tracking-tight">
                  <span class="bg-gradient-to-r from-text via-text to-muted bg-clip-text text-transparent">404</span>
                </div>
              </div>
              <div class="mt-1">
                <Icon name="question-mark" size={26} class="text-muted" />
              </div>
            </div>

            <p class="mt-4 text-sm text-muted leading-relaxed max-w-prose">
              Wenn du von einer anderen Seite hier gelandet bist, kann der Link veraltet sein. Du findest alles Wichtige über die
              Schnelllinks — oder springst direkt zur Startseite.
            </p>

            <div class="mt-6 flex flex-wrap gap-3">
              <Button href="/" variant="primary" ariaLabel="Zur Startseite">
                <Icon name="arrow-left" size={16} />
                Startseite
              </Button>

              <Button id="backBtn" variant="secondary" ariaLabel="Eine Seite zurück">
                <Icon name="corner-up-left" size={16} />
                Zurück
              </Button>

              <Button href="/#contact" variant="ghost" ariaLabel="Zum Kontakt springen">
                Kontakt
                <Icon name="arrow-right" size={16} />
              </Button>
            </div>

            <p data-back-fallback class="mt-3 text-xs text-muted hidden">
              Tipp: Dein Browser hat keine Historie. Nutze „Startseite“.
            </p>
          </div>

          <div class="mt-6 text-sm text-muted">
            <span class="meta">URL</span>
            <div class="mt-2 flex items-center gap-2">
              <Icon name="link" size={16} class="text-muted" />
              <code class="rounded-md border border-border/70 bg-bg/40 px-2 py-1 text-xs">{Astro.url.pathname}</code>
            </div>
          </div>
        </section>

        <aside class="reveal" style="--reveal-delay: 140ms">
          <div class="meta">Schnell wieder rein</div>
          <Divider class="mt-3" />

          <div class="mt-6 border-t border-border/70">
            {quickLinks.map((l, i) => (
              <a
                href={l.href}
                class="group w-full flex items-center justify-between gap-4 py-4 border-b border-border/70 hover:bg-surface/30 transition"
                style={`--reveal-delay: ${Math.min(i * 35, 175)}ms`}
              >
                <div class="flex items-center gap-3 min-w-0 flex-1 overflow-hidden">
                  <Icon
                    name={l.icon}
                    size={18}
                    class="text-muted group-hover:text-text transition-colors"
                  />
                  <div class="min-w-0 flex-1">
                    <div class="text-sm font-[450] text-text">{l.label}</div>
                    <div class="text-xs text-muted truncate hidden sm:block">{l.href}</div>
                  </div>
                </div>
                <Icon
                  name={l.href.startsWith("/") ? "arrow-right" : "arrow-up-right"}
                  size={16}
                  class="text-muted group-hover:text-text transition-colors"
                />
              </a>
            ))}
          </div>
        </aside>
      </div>
    </div>
  </main>

  <Footer />

  <script is:inline>
    (() => {
      // „Zurück“ fühlt sich auf einer 404 Seite natürlich an.
      // Wenn es keine Historie gibt, zeigen wir einen Hinweis und schicken zur Startseite.
      const btn = document.getElementById("backBtn");
      const hint = document.querySelector("[data-back-fallback]");
      if (!btn) return;

      btn.addEventListener("click", () => {
        if (window.history.length > 1) {
          window.history.back();
          return;
        }

        hint?.classList.remove("hidden");
        window.location.href = "/";
      });
    })();
  </script>
</BaseLayout>
